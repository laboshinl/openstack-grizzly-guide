
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Ручная установка &mdash; openstack 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-2.3.0/css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-2.3.0/css/bootstrap-responsive.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-2.3.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="openstack 1.0 documentation" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>
<div class="container">
  
  <div id="navbar" class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner"><div class="container">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a class="brand" href="openstack-grizzly-guide.html">OpenStack</a>
      <span class="navbar-text pull-left"><b>Grizzly</b></span>

      <div class="nav-collapse">
        <ul class="nav">
          <li class="divider-vertical"></li>
          
            <li class="dropdown globaltoc-container">
  <a href="openstack-grizzly-guide.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Страницы <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="openstack-grizzly-installation-prerequisites.html">Подготовка к установке</a></li>
<li class="toctree-l1"><a class="reference internal" href="openstack-grizzly-manual-installation.html">Ручная установка</a><ul>
<li class="toctree-l2"><a class="reference internal" href="openstack-grizzly-manual-installation.html#id2">Установка контроллера облака</a></li>
<li class="toctree-l2"><a class="reference internal" href="openstack-grizzly-manual-installation.html#id11">Добавление вычислительных узлов</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="openstack-grizzly-automatic-installation.html">Автоматическая установка</a><ul>
<li class="toctree-l2"><a class="reference internal" href="openstack-grizzly-automatic-installation.html#id2">Подготовка управляющего компьютера</a></li>
<li class="toctree-l2"><a class="reference internal" href="openstack-grizzly-automatic-installation.html#id3">Установка контроллера облака</a></li>
<li class="toctree-l2"><a class="reference internal" href="openstack-grizzly-automatic-installation.html#id4">Добавление вычислительных узлов</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="openstack-grizzly-usage.html">Работа с системой</a><ul>
<li class="toctree-l2"><a class="reference internal" href="openstack-grizzly-usage.html#id2">Образы виртуальных машин</a></li>
<li class="toctree-l2"><a class="reference internal" href="openstack-grizzly-usage.html#cloudpipe">Cloudpipe</a></li>
</ul>
</li>
</ul>
</ul>
</li>
            <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Навигация <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Ручная установка</a><ul>
<li><a class="reference internal" href="#id2">Установка контроллера облака</a><ul>
<li><a class="reference internal" href="#ceph">CEPH</a></li>
<li><a class="reference internal" href="#keystone">Keystone</a></li>
<li><a class="reference internal" href="#glance">Glance</a></li>
<li><a class="reference internal" href="#nova">Nova</a></li>
<li><a class="reference internal" href="#cinder">Cinder</a></li>
<li><a class="reference internal" href="#dashboard">Dashboard</a></li>
<li><a class="reference internal" href="#quantum">Quantum</a></li>
<li><a class="reference internal" href="#swift">Swift</a></li>
<li><a class="reference internal" href="#munin">Munin</a></li>
<li><a class="reference internal" href="#mydns">MyDNS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id11">Добавление вычислительных узлов</a><ul>
<li><a class="reference internal" href="#id12">Quantum</a></li>
<li><a class="reference internal" href="#id13">Nova</a></li>
<li><a class="reference internal" href="#id14">Swift</a></li>
<li><a class="reference internal" href="#id15">Ceph</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
          
          
            
          
        </ul>

        
          
<form class="navbar-search pull-right" style="margin-bottom:-3px;" action="search.html" method="get">
  <input type="text" name="q" placeholder="Поиск" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        
      </div>
    </div>
  </div>
</div>

  
  <div class="section" id="id1">
<h1>Ручная установка<a class="headerlink" href="#id1" title="Ссылка на этот заголовок">¶</a></h1>
<div class="section" id="id2">
<h2>Установка контроллера облака<a class="headerlink" href="#id2" title="Ссылка на этот заголовок">¶</a></h2>
<div class="section" id="ceph">
<span id="filesystem"></span><h3>CEPH<a class="headerlink" href="#ceph" title="Ссылка на этот заголовок">¶</a></h3>
<p><a class="reference external" href="http://ceph.com">Ceph</a> — свободная распределённая файловая система. Ceph может использоваться на системах, состоящих как из нескольких машин, так и из тысяч узлов. Общий объем хранилища данных может измеряться петабайтами, встроенные механизмы продублированной репликации данных (не зависит от отказа отдельных узлов) обеспечивают чрезвычайно высокую живучесть системы, при добавлении или удалении новых узлов, массив данных автоматически перебалансируется с учетом новшеств.</p>
<p>Установка</p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">gpg</span> <span class="pre">--keyserver</span> <span class="pre">keyserver.ubuntu.com</span> <span class="pre">--recv</span> <span class="pre">17ED316D</span></tt></p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">gpg</span> <span class="pre">--export</span> <span class="pre">--armor</span> <span class="pre">17ED316D</span> <span class="pre">|</span> <span class="pre">apt-key</span> <span class="pre">add</span> <span class="pre">-</span></tt></p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">apt-get</span> <span class="pre">update</span></tt></p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">ceph</span></tt></p>
<p>Необходимо добавить репозиторий &#8220;Grizzly&#8221;</p>
<p><tt class="docutils literal"><span class="pre">echo</span> <span class="pre">&quot;deb</span> <span class="pre">http://ppa.launchpad.net/openstack-ubuntu-testing/grizzly-trunk-testing/ubuntu/</span> <span class="pre">precise</span> <span class="pre">main&quot;</span> <span class="pre">&gt;&gt;</span> <span class="pre">/etc/apt/sources.list</span></tt></p>
<p>Получение ключа</p>
<p><tt class="docutils literal"><span class="pre">gpg</span> <span class="pre">--keyserver</span> <span class="pre">keyserver.ubuntu.com</span> <span class="pre">--recv</span> <span class="pre">3B6F61A6</span> <span class="pre">&amp;&amp;</span> <span class="pre">gpg</span> <span class="pre">--export</span> <span class="pre">--armor</span> <span class="pre">3B6F61A6</span> <span class="pre">|</span> <span class="pre">apt-key</span> <span class="pre">add</span> <span class="pre">-</span></tt></p>
<p>Обновление списка пакетов</p>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">update</span></tt></p>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">mysql-server</span> <span class="pre">python-mysqldb</span> <span class="pre">-y</span></tt></p>
<p><tt class="docutils literal"><span class="pre">sed</span> <span class="pre">-i</span> <span class="pre">'s/127.0.0.1/10.10.10.0/g'</span> <span class="pre">/etc/mysql/my.cnf</span></tt></p>
<div class="admonition hint">
<p class="first admonition-title">Подсказка</p>
<p class="last">Здесь <strong>10.10.10.0</strong> ip-адрес сетевого интерфейса во внутренней сети</p>
</div>
<p><tt class="docutils literal"><span class="pre">service</span> <span class="pre">mysql</span> <span class="pre">restart</span></tt></p>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">rabbitmq-server</span></tt></p>
</div>
<div class="section" id="keystone">
<span id="id4"></span><h3>Keystone<a class="headerlink" href="#keystone" title="Ссылка на этот заголовок">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">keystone</span></tt></p>
<p><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-uroot</span> <span class="pre">-pMysqlPass</span> <span class="pre">-e</span> <span class="pre">&quot;CREATE</span> <span class="pre">DATABASE</span> <span class="pre">keystone;&quot;</span></tt></p>
<p><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-uroot</span> <span class="pre">-pMysqlPass</span> <span class="pre">-e</span> <span class="pre">&quot;GRANT</span> <span class="pre">ALL</span> <span class="pre">PRIVILEGES</span> <span class="pre">ON</span> <span class="pre">*.*</span> <span class="pre">TO</span> <span class="pre">'root'&#64;'%'</span> <span class="pre">IDENTIFIED</span> <span class="pre">BY</span> <span class="pre">'MysqlPass';&quot;</span></tt></p>
<div class="admonition hint">
<p class="first admonition-title">Подсказка</p>
<p class="last">Здесь и далее <strong>MysqlPass</strong> - пароль, введенный при установке пакета mysql-server</p>
</div>
<p>В конфигурационном файле /etc/keystone/keystone.conf необходимо:</p>
<blockquote>
<div><ul>
<li><p class="first">раскоментировать строчку и изменить токен в секции [DEFAULT]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">admin_token</span> <span class="o">=</span> <span class="n">AdminToken</span>
</pre></div>
</div>
</li>
<li><p class="first">в секции [sql] указать путь к созданной базе данных:</p>
<div class="highlight-python"><pre>connection = mysql://root:MysqlPass@10.10.10.0/keystone</pre>
</div>
</li>
<li><p class="first">секцию [catalog] привести к следующему виду:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># dynamic, sql-based backend (supports API/CLI-based management commands)</span>
<span class="c"># driver = keystone.catalog.backends.sql.Catalog</span>

<span class="c"># static, file-based backend (does *NOT* support any management commands)</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">keystone</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">templated</span><span class="o">.</span><span class="n">TemplatedCatalog</span>
<span class="n">template_file</span> <span class="o">=</span> <span class="n">default_catalog</span><span class="o">.</span><span class="n">templates</span>
</pre></div>
</div>
</li>
<li><p class="first">в секции [signing]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">token_format</span> <span class="o">=</span> <span class="n">UUID</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>Перезапуск сервиса</p>
<p><tt class="docutils literal"><span class="pre">service</span> <span class="pre">keystone</span> <span class="pre">restart</span></tt></p>
<p>Синхронизация с базой данных</p>
<p><tt class="docutils literal"><span class="pre">keystone-manage</span> <span class="pre">db_sync</span></tt></p>
<p>Аутентификация</p>
<p><tt class="docutils literal"><span class="pre">export</span> <span class="pre">SERVICE_TOKEN=AdminToken</span></tt></p>
<p><tt class="docutils literal"><span class="pre">export</span> <span class="pre">SERVICE_ENDPOINT=&quot;http://10.10.10.0:35357/v2.0&quot;</span></tt></p>
<p>Для дальнейшей работы необходимо создать два проекта. Проект, роль, и пользователь <strong>admin</strong>, необходим для функционирования сервисов и администрирования облака.</p>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">tenant-create</span> <span class="pre">--name=admin</span></tt></p>
<div class="highlight-python"><pre>+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |                                  |
|   enabled   |               True               |
|      id     | 1f155208db0a4c959365a0002b8b507e |
|     name    |              admin               |
+-------------+----------------------------------+</pre>
</div>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">user-create</span> <span class="pre">--name=admin</span> <span class="pre">--pass=cl0udAdmin</span> <span class="pre">--email=cloud&#64;admin.com</span></tt></p>
<div class="highlight-python"><pre>+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
|  email   |         cloud@admin.com          |
| enabled  |               True               |
|    id    | 1d2a73ea87f249769f6669ee2f812932 |
|   name   |              admin               |
| tenantId |                                  |
+----------+----------------------------------+</pre>
</div>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">role-create</span> <span class="pre">--name=admin</span></tt></p>
<div class="highlight-python"><pre>+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
|    id    | 424f7b79893c4266bf5753894a4668d2 |
|   name   |              admin               |
+----------+----------------------------------+</pre>
</div>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">user-role-add</span> <span class="pre">--user-id</span> <span class="pre">1d2a73ea87f249769f6669ee2f812932</span> <span class="pre">--role-id</span> <span class="pre">424f7b79893c4266bf5753894a4668d2</span> <span class="pre">--tenant-id</span> <span class="pre">1f155208db0a4c959365a0002b8b507e</span></tt></p>
<p>Роль <strong>Member</strong> - роль по умолчанию для добавления пользователей облака. Пользователь <strong>tester</strong> и проект <strong>test</strong> необходимы для проверки работы сервисов облачной инфраструктуры после установки.</p>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">tenant-create</span> <span class="pre">--name=test</span></tt></p>
<div class="highlight-python"><pre>+-------------+----------------------------------+
|   Property  |              Value               |
+-------------+----------------------------------+
| description |                                  |
|   enabled   |               True               |
|      id     | 37cfbd624d0242b995fa695d8b134bb6 |
|     name    |               test               |
+-------------+----------------------------------+</pre>
</div>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">user-create</span> <span class="pre">--name=tester</span> <span class="pre">--pass=cl0udAdmin</span> <span class="pre">--email=cloud&#64;admin.com</span></tt></p>
<div class="highlight-python"><pre>+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
|  email   |         cloud@admin.com          |
| enabled  |               True               |
|    id    | cf0828666bfd4a24b12dcd83848ef360 |
|   name   |              tester              |
| tenantId |                                  |
+----------+----------------------------------+</pre>
</div>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">role-create</span> <span class="pre">--name=Member</span></tt></p>
<div class="highlight-python"><pre>+----------+----------------------------------+
| Property |              Value               |
+----------+----------------------------------+
|    id    | 01242eec84c14106a10759e210c98dee |
|   name   |              Member              |
+----------+----------------------------------+</pre>
</div>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">user-role-add</span> <span class="pre">--user-id</span> <span class="pre">cf0828666bfd4a24b12dcd83848ef360</span> <span class="pre">--role-id</span> <span class="pre">01242eec84c14106a10759e210c98dee</span> <span class="pre">--tenant-id</span> <span class="pre">37cfbd624d0242b995fa695d8b134bb6</span></tt></p>
<p>Файл /etc/keystone/default_catalog.templates необходимо привести к следующему виду</p>
<div class="highlight-python"><pre># config for TemplatedCatalog, using camelCase because I don't want to do
# translations for keystone compat
catalog.RegionOne.identity.publicURL = http://195.208.117.140:$(public_port)s/v2.0
catalog.RegionOne.identity.adminURL = http://195.208.117.140:$(admin_port)s/v2.0
catalog.RegionOne.identity.internalURL = http://195.208.117.140:$(public_port)s/v2.0
catalog.RegionOne.identity.name = Identity Service

# fake compute service for now to help novaclient tests work
catalog.RegionOne.compute.publicURL = http://195.208.117.140:$(compute_port)s/v1.1/$(tenant_id)s
catalog.RegionOne.compute.adminURL = http://195.208.117.140:$(compute_port)s/v1.1/$(tenant_id)s
catalog.RegionOne.compute.internalURL = http://195.208.117.140:$(compute_port)s/v1.1/$(tenant_id)s
catalog.RegionOne.compute.name = Compute Service

catalog.RegionOne.volume.publicURL = http://195.208.117.140:8776/v1/$(tenant_id)s
catalog.RegionOne.volume.adminURL = http://195.208.117.140:8776/v1/$(tenant_id)s
catalog.RegionOne.volume.internalURL = http://195.208.117.140:8776/v1/$(tenant_id)s
catalog.RegionOne.volume.name = Volume Service

catalog.RegionOne.ec2.publicURL = http://195.208.117.140:8773/services/Cloud
catalog.RegionOne.ec2.adminURL = http://195.208.117.140:8773/services/Admin
catalog.RegionOne.ec2.internalURL = http://195.208.117.140:8773/services/Cloud
catalog.RegionOne.ec2.name = EC2 Service

catalog.RegionOne.image.publicURL = http://195.208.117.140:9292/v1
catalog.RegionOne.image.adminURL = http://195.208.117.140:9292/v1
catalog.RegionOne.image.internalURL = http://195.208.117.140:9292/v1
catalog.RegionOne.image.name = Image Service

catalog.RegionOne.network.publicURL = http://195.208.117.140:9696
catalog.RegionOne.network.adminURL = http://195.208.117.140:9696
catalog.RegionOne.network.internalURL = http://195.208.117.140:9696
catalog.RegionOne.network.name = Network Service

catalog.RegionOne.object_store.publicURL = http://195.208.117.140:8080/v1/AUTH_$(tenant_id)s
catalog.RegionOne.object_store.adminURL = http://195.208.117.140:8080/
catalog.RegionOne.object_store.internalURL = http://195.208.117.140:8080/v1/AUTH_$(tenant_id)s
catalog.RegionOne.object_store.name = S3 Service</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Примечание</p>
<p class="last">Здесь и далее <strong>195.208.117.140</strong> ip-адрес сетевого интерфейса контроллера облака во внешней сети</p>
</div>
<p><tt class="docutils literal"><span class="pre">keystone</span> <span class="pre">user-list</span></tt></p>
<div class="highlight-python"><pre>+----------------------------------+--------+---------+-----------------+
|                id                |  name  | enabled |      email      |
+----------------------------------+--------+---------+-----------------+
| 1d2a73ea87f249769f6669ee2f812932 | admin  |   True  | cloud@admin.com |
| cf0828666bfd4a24b12dcd83848ef360 | tester |   True  | cloud@admin.com |
+----------------------------------+--------+---------+-----------------+</pre>
</div>
</div>
<div class="section" id="glance">
<span id="id5"></span><h3>Glance<a class="headerlink" href="#glance" title="Ссылка на этот заголовок">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">glance</span></tt></p>
<p><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-uroot</span> <span class="pre">-pMysqlPass</span> <span class="pre">-e</span> <span class="pre">&quot;CREATE</span> <span class="pre">DATABASE</span> <span class="pre">glance;&quot;</span></tt></p>
<p>В конфигурационных файлах /etc/glance glance-api.conf и /etc/glance/glance-registry.conf необходимо изменить:</p>
<div class="highlight-python"><pre>[DEFAULT]
sql_connection = mysql://root@MysqlPass@10.10.10.0/glance

[keystone_authtoken]
auth_host = 127.0.0.1
auth_port = 35357
auth_protocol = http
admin_tenant_name = admin
admin_user = admin
admin_password = cl0udAdmin

[paste_deploy]
flavor = keystone</pre>
</div>
<p><tt class="docutils literal"><span class="pre">service</span> <span class="pre">glance-api</span> <span class="pre">restart</span></tt></p>
<p><tt class="docutils literal"><span class="pre">service</span> <span class="pre">glance-registry</span> <span class="pre">restart</span></tt></p>
<p><tt class="docutils literal"><span class="pre">glance-manage</span> <span class="pre">db_sync</span></tt></p>
<div class="admonition warning">
<p class="first admonition-title">Предупреждение</p>
<p class="last">Glance требует версию пакета warlock&gt;=0.7.0,&lt;2 а в репозитории Ubuntu &#8216;Precise&#8217; версия 0.1.0, необходимо установить свежую версию с помощью pip install</p>
</div>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">python-pip</span></tt></p>
<p><tt class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">warlock</span> <span class="pre">--upgrade</span></tt></p>
<p>Команды Glance</p>
<p>Загрузка тестового образа</p>
<p><tt class="docutils literal"><span class="pre">glance</span> <span class="pre">image-create</span> <span class="pre">--name</span> <span class="pre">cirros-0.3.0</span> <span class="pre">--is-public</span> <span class="pre">true</span> <span class="pre">--container-format</span> <span class="pre">bare</span> <span class="pre">--disk-format</span> <span class="pre">qcow2</span> <span class="pre">--copy-from</span> <span class="pre">https://launchpad.net/cirros/trunk/0.3.0/+download/cirros-0.3.0-x86_64-disk.img</span></tt></p>
<div class="admonition note">
<p class="first admonition-title">Примечание</p>
<p class="last">Для тестового образа cirros-0.3.0 помимо ssh-ключа для авторизации можно использовать  логин <strong>cirros</strong> и пароль <strong>cubswin:)</strong></p>
</div>
</div>
<div class="section" id="nova">
<span id="id6"></span><h3>Nova<a class="headerlink" href="#nova" title="Ссылка на этот заголовок">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">nova-api</span> <span class="pre">nova-cert</span> <span class="pre">novnc</span> <span class="pre">nova-consoleauth</span> <span class="pre">nova-scheduler</span></tt></p>
<p><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-uroot</span> <span class="pre">-pMysqlPass</span> <span class="pre">-e</span> <span class="pre">&quot;CREATE</span> <span class="pre">DATABASE</span> <span class="pre">nova;&quot;</span></tt></p>
<p>В файле /etc/nova/api-paste.ini:</p>
<div class="highlight-python"><pre>[filter:authtoken]
paste.filter_factory = keystoneclient.middleware.auth_token:filter_factory
auth_host = 127.0.0.1
auth_port = 35357
auth_protocol = http
admin_tenant_name = admin
admin_user = admin
admin_password = cl0udAdmin
signing_dir = /tmp/keystone-signing-nova</pre>
</div>
<p>В файле /etc/nova/nova.conf:</p>
<div class="highlight-python"><pre>[DEFAULT]
logdir=/var/log/nova
state_path=/var/lib/nova
lock_path=/run/lock/nova
verbose=True
api_paste_config=/etc/nova/api-paste.ini
compute_scheduler_driver = nova.scheduler.filter_scheduler.FilterScheduler
s3_host=10.10.10.0
ec2_host=10.10.10.0
ec2_dmz_host=10.10.10.0
rabbit_host=10.10.10.0
cc_host=10.10.10.0
dmz_cidr=169.254.169.254/32
metadata_host=10.10.10.0
metadata_listen=0.0.0.0
nova_url=http://10.10.10.0:8774/v1.1/
sql_connection=mysql://root:MysqlPass@10.10.10.0/nova
ec2_url=http://10.10.10.0:8773/services/Cloud
root_helper=sudo nova-rootwrap /etc/nova/rootwrap.conf

# Auth
use_deprecated_auth=false
auth_strategy=keystone
keystone_ec2_url=http://10.10.10.0:5000/v2.0/ec2tokens
# Imaging service
glance_api_servers=10.10.10.0:9292
image_service=nova.image.glance.GlanceImageService

# Vnc configuration
novnc_enabled=true
novncproxy_base_url=http://195.208.117.140:6080/vnc_auto.html
novncproxy_port=6080
vncserver_proxyclient_address=195.208.117.140
vncserver_listen=0.0.0.0

# Network settings
network_api_class=nova.network.quantumv2.api.API
quantum_url=http://10.10.10.0:9696
quantum_auth_strategy=keystone
quantum_admin_tenant_name=service
quantum_admin_username=quantum
quantum_admin_password=service_pass
quantum_admin_auth_url=http://10.10.10.0:35357/v2.0
libvirt_vif_driver=nova.virt.libvirt.vif.LibvirtHybridOVSBridgeDriver
linuxnet_interface_driver=nova.network.linux_net.LinuxOVSInterfaceDriver
firewall_driver=nova.virt.libvirt.firewall.IptablesFirewallDriver

# Compute #
compute_driver=libvirt.LibvirtDriver

# Cinder #
volume_api_class=nova.volume.cinder.API
osapi_volume_listen_port=5900</pre>
</div>
<p>Синхронизация с базой</p>
<p><tt class="docutils literal"><span class="pre">nova-manage</span> <span class="pre">db_sync</span></tt></p>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">kvm</span> <span class="pre">libvirt-bin</span> <span class="pre">pm-utils</span> <span class="pre">nova-conductor</span></tt></p>
<p>Перезапуск сервисов</p>
<p><tt class="docutils literal"><span class="pre">find</span> <span class="pre">/etc/init.d</span> <span class="pre">-name</span> <span class="pre">nova*</span> <span class="pre">-exec</span> <span class="pre">{}</span> <span class="pre">restart</span> <span class="pre">\;</span></tt></p>
<div class="admonition hint">
<p class="first admonition-title">Подсказка</p>
<p class="last">Посмотреть список работающих сервисов Nova можно командой nova-manage service list</p>
</div>
</div>
<div class="section" id="cinder">
<span id="id7"></span><h3>Cinder<a class="headerlink" href="#cinder" title="Ссылка на этот заголовок">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">cinder-api</span> <span class="pre">cinder-scheduler</span> <span class="pre">cinder-volume</span> <span class="pre">iscsitarget</span> <span class="pre">open-iscsi</span> <span class="pre">iscsitarget-dkms</span></tt></p>
<p><tt class="docutils literal"><span class="pre">sed</span> <span class="pre">-i</span> <span class="pre">'s/false/true/g'</span> <span class="pre">/etc/default/iscsitarget</span></tt></p>
<p><tt class="docutils literal"><span class="pre">service</span> <span class="pre">iscsitarget</span> <span class="pre">start</span></tt></p>
<p><tt class="docutils literal"><span class="pre">service</span> <span class="pre">open-iscsi</span> <span class="pre">start</span></tt></p>
<p><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-uroot</span> <span class="pre">-pMysqlPass</span> <span class="pre">-e</span> <span class="pre">&quot;CREATE</span> <span class="pre">DATABASE</span> <span class="pre">cinder;&quot;</span></tt></p>
<p>В файле /etc/cinder/api-pate.ini:</p>
<div class="highlight-python"><pre>[filter:authtoken]
paste.filter_factory = keystoneclient.middleware.auth_token:filter_factory
service_protocol = http
service_host = 127.0.0.1
service_port = 5000
auth_host = 127.0.0.1
auth_port = 35357
auth_protocol = http
admin_tenant_name = admin
admin_user = admin
admin_password = cl0udAdmin
signing_dir = /var/lib/cinder</pre>
</div>
<p>В файле /etc/cinder/cinder.conf:</p>
<div class="highlight-python"><pre>[DEFAULT]
rootwrap_config = /etc/cinder/rootwrap.conf
sql_connection = mysql://root:MysqlPass@10.10.10.0/cinder
api_paste_confg = /etc/cinder/api-paste.ini
iscsi_helper = tgtadm
volume_name_template = volume-%s
volume_group = tn0
verbose = True
auth_strategy = keystone
state_path = /var/lib/cinder
volumes_dir = /var/lib/cinder/volumes</pre>
</div>
<div class="admonition hint">
<p class="first admonition-title">Подсказка</p>
<p class="last">Здесь tn0 - название группы логических томов lvm2</p>
</div>
<p><tt class="docutils literal"><span class="pre">cinder-manage</span> <span class="pre">db</span> <span class="pre">sync</span></tt></p>
<p><tt class="docutils literal"><span class="pre">service</span> <span class="pre">cinder-volume</span> <span class="pre">restart</span></tt></p>
<p><tt class="docutils literal"><span class="pre">service</span> <span class="pre">cinder-api</span> <span class="pre">restart</span></tt></p>
</div>
<div class="section" id="dashboard">
<span id="horizon"></span><h3>Dashboard<a class="headerlink" href="#dashboard" title="Ссылка на этот заголовок">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">openstack-dashboard</span> <span class="pre">memcached</span> <span class="pre">node-less</span></tt></p>
</div>
<div class="section" id="quantum">
<span id="id8"></span><h3>Quantum<a class="headerlink" href="#quantum" title="Ссылка на этот заголовок">¶</a></h3>
<blockquote>
<div>pip install cliff &#8211;upgrade</div></blockquote>
</div>
<div class="section" id="swift">
<span id="id9"></span><h3>Swift<a class="headerlink" href="#swift" title="Ссылка на этот заголовок">¶</a></h3>
</div>
<div class="section" id="munin">
<span id="id10"></span><h3>Munin<a class="headerlink" href="#munin" title="Ссылка на этот заголовок">¶</a></h3>
</div>
<div class="section" id="mydns">
<span id="names"></span><h3>MyDNS<a class="headerlink" href="#mydns" title="Ссылка на этот заголовок">¶</a></h3>
</div>
</div>
<div class="section" id="id11">
<h2>Добавление вычислительных узлов<a class="headerlink" href="#id11" title="Ссылка на этот заголовок">¶</a></h2>
<div class="section" id="id12">
<h3>Quantum<a class="headerlink" href="#id12" title="Ссылка на этот заголовок">¶</a></h3>
</div>
<div class="section" id="id13">
<h3>Nova<a class="headerlink" href="#id13" title="Ссылка на этот заголовок">¶</a></h3>
</div>
<div class="section" id="id14">
<h3>Swift<a class="headerlink" href="#id14" title="Ссылка на этот заголовок">¶</a></h3>
</div>
<div class="section" id="id15">
<h3>Ceph<a class="headerlink" href="#id15" title="Ссылка на этот заголовок">¶</a></h3>
</div>
</div>
</div>


</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Наверх</a>
    </p>
    <p>
        &copy; 2013, Леонид Лабошин.<br/>
    </p>
  </div>
</footer>
  </body>
</html>